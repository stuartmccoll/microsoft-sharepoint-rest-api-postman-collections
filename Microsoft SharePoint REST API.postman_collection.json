{
	"info": {
		"_postman_id": "c197c2c0-e2c0-44e5-a9c8-25e9dfbcbb2e",
		"name": "Microsoft SharePoint REST API",
		"description": "A collection of Postman requests for the Microsoft SharePoint REST API.",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Application",
			"item": [
				{
					"name": "Get Access Token",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "610c5826-515e-4bcf-8ee8-878d9fd5635a",
								"exec": [
									"const json_response_body = JSON.parse(responseBody);",
									"postman.setEnvironmentVariable(\"appReg_bearerToken\", json_response_body.access_token);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "grant_type",
									"value": "client_credentials",
									"type": "text"
								},
								{
									"key": "client_id",
									"value": "{{appReg_clientId}}@{{realm}}",
									"type": "text"
								},
								{
									"key": "client_secret",
									"value": "{{appReg_clientSecret}}",
									"type": "text"
								},
								{
									"key": "resource",
									"value": "{{principal}}/{{targetHost}}@{{realm}}",
									"type": "text"
								}
							],
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "https://accounts.accesscontrol.windows.net/{{realm}}/tokens/OAuth/2",
							"protocol": "https",
							"host": [
								"accounts",
								"accesscontrol",
								"windows",
								"net"
							],
							"path": [
								"{{realm}}",
								"tokens",
								"OAuth",
								"2"
							]
						},
						"description": "Retrieves an access token for use in later Microsoft SharePoint REST API requests."
					},
					"response": []
				},
				{
					"name": "Get Realm GUID",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "74b499e8-03a0-4576-8e9d-deff8fa2fe9a",
								"exec": [
									"// Retrieve the realm GUID from the WWW-Authenticate header",
									"",
									"const response_headers = pm.response.headers.all();",
									"",
									"for (let i = 0; i < response_headers.length; i++) {",
									"    if (response_headers[i]['key'] === \"WWW-Authenticate\") {",
									"",
									"        // Retrieve the entire WWW-Authenticate header",
									"        const www_authenticate_header = response_headers[i]['value'];",
									"",
									"        // Find the index within the header of the realm key",
									"        const realm_position = www_authenticate_header.indexOf(\"realm\");",
									"",
									"        // Retrieve the realm GUID from the WWW-Authenticate header",
									"        const realm_guid = www_authenticate_header.substring((realm_position + 7), (realm_position + 43));",
									"",
									"        // Set the realm Postman environment variable",
									"        postman.setEnvironmentVariable(\"realm\", realm_guid);",
									"",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer",
								"type": "text"
							}
						],
						"url": {
							"raw": "https://{{targetHost}}/_vti_bin/client.svc/",
							"protocol": "https",
							"host": [
								"{{targetHost}}"
							],
							"path": [
								"_vti_bin",
								"client.svc",
								""
							]
						},
						"description": "This request will return an unauthorised response, but the small piece of JavaScript within the Test tab will set a realm environment variable if the request returns a WWW-Authenticate header containing a realm key."
					},
					"response": []
				}
			],
			"protocolProfileBehavior": {}
		},
		{
			"name": "Lists",
			"item": [
				{
					"name": "Get ListItemEntityTypeFullName",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "b8c497b2-1fe9-419e-9330-cf61ea4d831e",
								"exec": [
									"const json_response_body = JSON.parse(responseBody);",
									"postman.setEnvironmentVariable(\"ListItemEntityTypeFullName\", json_response_body.ListItemEntityTypeFullName);"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{appReg_bearerToken}}",
								"type": "text"
							},
							{
								"key": "Accept",
								"value": "application/json;odata=nometadata",
								"type": "text"
							}
						],
						"url": {
							"raw": "https://{{targetHost}}/_api/web/lists/GetByTitle('Test list')?$select=ListItemEntityTypeFullName",
							"protocol": "https",
							"host": [
								"{{targetHost}}"
							],
							"path": [
								"_api",
								"web",
								"lists",
								"GetByTitle('Test list')"
							],
							"query": [
								{
									"key": "$select",
									"value": "ListItemEntityTypeFullName"
								}
							]
						},
						"description": "Retrieves the ListItemEntityTypeFullName for the given SharePoint list and stores this as an environment variable for later use."
					},
					"response": []
				},
				{
					"name": "Create New List Item",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "16b5b2e7-613b-4417-8344-7333d6c4b8f0",
								"exec": [
									"// Obtain the ListItemEntityTypeFullName before sending request",
									"",
									"pm.sendRequest(",
									"    {",
									"        url: \"https://\" + pm.environment.get('targetHost') + \"/_api/web/lists/GetByTitle('Test list')?$select=ListItemEntityTypeFullName\",",
									"        header: {",
									"            \"Authorization\": \"Bearer \" + pm.environment.get('appReg_bearerToken'),",
									"            \"Accept\": \"application/json;odata=nometadata\"",
									"        }",
									"    },",
									"    function (err, response) {",
									"        const json_response_body = response.json();",
									"        postman.setEnvironmentVariable(\"ListItemEntityTypeFullName\", json_response_body.ListItemEntityTypeFullName);",
									"    }",
									");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{appReg_bearerToken}}",
								"type": "text"
							},
							{
								"key": "Accept",
								"value": "application/json;odata=verbose",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json;odata=verbose",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"__metadata\": {\n        \"type\": \"{{ListItemEntityTypeFullName}}\"\n    },\n    \"Title\": \"Item Name\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "https://{{targetHost}}/_api/web/lists/GetByTitle('Test list')/items",
							"protocol": "https",
							"host": [
								"{{targetHost}}"
							],
							"path": [
								"_api",
								"web",
								"lists",
								"GetByTitle('Test list')",
								"items"
							]
						},
						"description": "This request will create a new item in a given SharePoint list. Replace 'Test list' in the URL with your own SharePoint list name."
					},
					"response": []
				},
				{
					"name": "Create List",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "4cdec1bc-a80e-4bdb-87e3-a9271fd60778",
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"type": "text",
								"value": "Bearer {{appReg_bearerToken}}"
							},
							{
								"key": "Accept",
								"type": "text",
								"value": "application/json;odata=verbose"
							},
							{
								"key": "Content-Type",
								"type": "text",
								"value": "application/json;odata=verbose"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"__metadata\": {\n        \"type\": \"SP.List\"\n    },\n    \"AllowContentTypes\": true,\n    \"BaseTemplate\": 100,\n    \"ContentTypesEnabled\": true,\n    \"Description\": \"My list description\",\n    \"Title\": \"My List Title\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "https://{{targetHost}}/_api/web/lists",
							"protocol": "https",
							"host": [
								"{{targetHost}}"
							],
							"path": [
								"_api",
								"web",
								"lists"
							]
						},
						"description": "This request will create a new SharePoint list. Replace the 'Description' and 'Title' values in the request Body section with your chosen values."
					},
					"response": []
				},
				{
					"name": "Add File Attachment to List Item",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "af4c65b5-40e5-4618-bfa1-3845d12f12a3",
								"exec": [
									"// Obtain the ListItemEntityTypeFullName before sending request",
									"",
									"pm.sendRequest(",
									"    {",
									"        url: \"https://\" + pm.environment.get('targetHost') + \"/_api/web/lists/GetByTitle('Test list')?$select=ListItemEntityTypeFullName\",",
									"        header: {",
									"            \"Authorization\": \"Bearer \" + pm.environment.get('appReg_bearerToken'),",
									"            \"Accept\": \"application/json;odata=nometadata\"",
									"        }",
									"    },",
									"    function (err, response) {",
									"        const json_response_body = response.json();",
									"        postman.setEnvironmentVariable(\"ListItemEntityTypeFullName\", json_response_body.ListItemEntityTypeFullName);",
									"    }",
									");"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"type": "text",
								"value": "Bearer {{appReg_bearerToken}}"
							}
						],
						"body": {
							"mode": "file",
							"file": {
								"src": ""
							},
							"options": {
								"raw": {
									"language": "text"
								}
							}
						},
						"url": {
							"raw": "https://{{targetHost}}/_api/web/lists/GetByTitle('Test list')/items(1)/AttachmentFiles/add(FileName='filename.ext')",
							"protocol": "https",
							"host": [
								"{{targetHost}}"
							],
							"path": [
								"_api",
								"web",
								"lists",
								"GetByTitle('Test list')",
								"items(1)",
								"AttachmentFiles",
								"add(FileName='filename.ext')"
							]
						},
						"description": "This request will attach a file to a given SharePoint list item. Replace 'Test list' in the URL with your own SharePoint list name, '1' with your own SharePoint list item id and 'filename.ext' with your chosen file name and extension."
					},
					"response": []
				},
				{
					"name": "Get List Item",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{appReg_bearerToken}}",
								"type": "text"
							},
							{
								"key": "Accept",
								"value": "application/json;odata=verbose",
								"type": "text"
							}
						],
						"url": {
							"raw": "https://{{targetHost}}/_api/web/lists/GetByTitle('Test list')/items(1)",
							"protocol": "https",
							"host": [
								"{{targetHost}}"
							],
							"path": [
								"_api",
								"web",
								"lists",
								"GetByTitle('Test list')",
								"items(1)"
							]
						},
						"description": "This request will retrieve a given list item by the id of the item. Replace 'Test list' with your own SharePoint list name, and replace '1' with the id of the item you are trying to retrieve."
					},
					"response": []
				},
				{
					"name": "Get List (By GUID)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"type": "text",
								"value": "Bearer {{appReg_bearerToken}}"
							},
							{
								"key": "Accept",
								"type": "text",
								"value": "application/json;odata=verbose"
							}
						],
						"url": {
							"raw": "https://{{targetHost}}/_api/web/lists(guid'{list_guid')",
							"protocol": "https",
							"host": [
								"{{targetHost}}"
							],
							"path": [
								"_api",
								"web",
								"lists(guid'{list_guid')"
							]
						},
						"description": "This request will retrieve a SharePoint list using the specified list GUID. Replace \"{list_guid}\" with your own SharePoint list GUID."
					},
					"response": []
				},
				{
					"name": "Get List (By Title)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"type": "text",
								"value": "Bearer {{appReg_bearerToken}}"
							},
							{
								"key": "Accept",
								"type": "text",
								"value": "application/json;odata=verbose"
							}
						],
						"url": {
							"raw": "https://{{targetHost}}/_api/web/lists/GetByTitle('{list_title}')",
							"protocol": "https",
							"host": [
								"{{targetHost}}"
							],
							"path": [
								"_api",
								"web",
								"lists",
								"GetByTitle('{list_title}')"
							]
						},
						"description": "This request will retrieve a SharePoint list using the specified list title. Replace \"{list_title}\" with your own SharePoint list title."
					},
					"response": []
				}
			],
			"protocolProfileBehavior": {}
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "c8e5ce96-0857-4b1c-99a4-255e17c9f28d",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "bcbdc8dc-5d2e-4241-9c6b-0d48d4340898",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"protocolProfileBehavior": {}
}